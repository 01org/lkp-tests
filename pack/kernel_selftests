#!/bin/bash

download()
{
	[[ -d linux ]] || git clone --depth 1 --reference /c/linux http://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git
	source_dir="linux"
}

build()
{
	cd $source_dir
	make allyesconfig
	make &
	pid=$!
	sleep 5
	kill $pid
	cd tools/testing/selftests
	for mf in */Makefile; do
		make -C ${mf%/Makefile}
	done
}

install()
{
	cp -af * $BM_ROOT
	find $BM_ROOT -name "*.c" -exec rm -f {} \;
	find $BM_ROOT -name "Makefile" -exec sed -i 's/\(run_tests:\) all/\1/' {} \;
}
