pkgname=mongodb
pkgver=r4.1.6
pkgrel=0
arch=('i686' 'x86_64')
url="https://www.mongodb.com/"
pkgdesc="A high-performance, open source, schema-free document-oriented database"
license=('AGPL3')
depends=()
source=("https://github.com/mongodb/mongo.git")
sha256sums=('SKIP')

build() {
	local PIP=pip

	which pip2 >/dev/null && PIP=$(which pip2)

	cd "${srcdir}/mongo"
	git checkout -f r4.1.6
	for i in $(seq 1 10)
	do
		$PIP install -i https://mirrors.aliyun.com/pypi/simple --user -r etc/pip/dev-requirements.txt && break
	done
	buildscripts/scons.py all --disable-warnings-as-errors -j $(nproc)
}

package() {
	mkdir -p "${pkgdir}/lkp/benchmarks/${pkgname}/bin"
	cd "${srcdir}/mongo"
	cp mongo* "${pkgdir}/lkp/benchmarks/${pkgname}/bin"
}
